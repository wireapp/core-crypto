[package]
name = "core-crypto"
description = "Abstraction over OpenMLS with persistent keystore"
repository = "https://github.com/wireapp/core-crypto"
version = "0.5.2"
edition = "2021"
license = "GPL-3.0-only"
publish = false

[lib]
name = "core_crypto"
crate-type = ["lib", "cdylib"]

[dependencies]
thiserror = "1.0"
hex = "0.4"
async-recursion = "1.0"

openmls = "0.4"
openmls_traits = "0.1"
# FIXME: This is being pulled only because of flaky error types from openmls
tls_codec = "0.2"
serde_json = "1.0"
derive_more = { version = "0.99", features = ["deref"] }

[dependencies.core-crypto-keystore]
version = "0.5"
path = "../keystore"

[dependencies.mls-crypto-provider]
version = "0.5"
path = "../mls-provider"

[dev-dependencies]
uuid = { version = "1.0", features = ["v4", "v5"] }
rand = "0.8"
tempfile = "3.3"
wasm-bindgen-test = "0.3"
rstest = "0.15"
rstest_reuse = "0.4"
rcgen = { version = "=0.9.2", features = ["x509-parser"] }
async-std = { version = "1.12", features = ["attributes"] }
futures-util = { version = "0.3", features = ["std", "alloc"] }
futures-lite = "1.12"

[target.'cfg(not(target_family = "wasm"))'.dev-dependencies.criterion]
version = "0.3"
features = ["async_futures", "html_reports"]

[dev-dependencies.core-crypto-attributes]
version = "0.5"
path = "../crypto-attributes"

[package.metadata.wasm-pack.profile.release]
wasm-opt = ["-Os", "--enable-mutable-globals", "--enable-threads", "--detect-features"]

[[bench]]
name = "key_package"
harness = false

[[bench]]
name = "proposal"
harness = false

[[bench]]
name = "public_group_state"
harness = false

[[bench]]
name = "commit"
harness = false

[[bench]]
name = "encryption"
harness = false

[[bench]]
name = "create_group"
harness = false
